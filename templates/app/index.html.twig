{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} - Test Technique{% endblock %}

{% block body %}
	<div class="row">
		<div class="col-md-6">
			{% for point in pointsOfInterest %}
				{% include 'app/_pointOfInterest.html.twig' with {'point': point} only %}
			{% else %}
				Aucun point d'intérêt n'est enregistré.
			{% endfor %}
		</div>
		<div class="col-md-6">
			
		</div>
	</div>

	{% include 'app/_newPointModal.html.twig' with {'form': newPointForm} only %}
{% endblock %}

{% block javascripts %}
	<script type="text/javascript">
		$('body').on('submit', '#new_point_form', function (e) {
	        e.preventDefault();
	        $.ajax({
	            type: $(this).attr('method'),
	            url:  $(this).attr('action'),
	            data: $(this).serialize()
	        })
	        .done(function (data) {
	        	var name = $('#point_name').val();
	        	var address = $('#point_address').val();
	        	var latitude = $('#point_latitude').val();
	        	var longitude = $('#point_longitude').val();
	            addPointToMap(name, address, latitude, longitude);
	            $('#new_point_form input').val('');
	        })
	        .fail(function (jqXHR, textStatus, errorThrown) {
	            if (typeof jqXHR.responseJSON !== 'undefined') {
	                if (jqXHR.responseJSON.hasOwnProperty('form')) {
	                    console.log(jqXHR.responseJSON.form);
	                }
	                console.log(jqXHR.responseJSON.message);
	            } else {
	                alert(errorThrown);
	            }
	        });
	    });

	    function addPointToMap(name, address, latitude, longitude) {
	    	console.log('TODO: addPointToMap');
	    }
	</script>
{% endblock %}